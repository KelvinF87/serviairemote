# ServIAIRemote

ServIAIRemote es un servidor Express que act√∫a como intermediario para consultas a OpenRouter AI. Permite gestionar peticiones de chat y manejar respuestas de IA de manera eficiente.

## üöÄ Caracter√≠sticas

- Uso de `Express.js` para manejar solicitudes HTTP.
- Integraci√≥n con `OpenRouter AI` para generar respuestas basadas en IA.
- Configuraci√≥n de variables de entorno mediante `dotenv`.
- Registro de solicitudes con `morgan`.
- Seguridad con `CORS` habilitado para todos los or√≠genes.
- Manejo de errores robusto para asegurar estabilidad.
- Uso de `nodemon` para reinicio autom√°tico del servidor en desarrollo.
- Utilizaci√≥n de `mongoose` para interacci√≥n con bases de datos MongoDB.
- `express-validator` para validaci√≥n de datos de las peticiones.
- `jsonwebtoken` para autenticaci√≥n y autorizaci√≥n mediante tokens JWT.
- `cookie-parser` para manejo de cookies en las peticiones.
- `express-rate-limit` para limitar el n√∫mero de peticiones por cliente y prevenir abusos.
- `node-fetch` para realizar peticiones HTTP a OpenRouter y otros servicios.
- `sib-api-v3-sdk` para integraci√≥n con Sendinblue (Brevo) para env√≠o de emails.
- `bcryptjs` para encriptaci√≥n segura de contrase√±as.

## üìå Requisitos

Aseg√∫rate de tener instalado:

- [Node.js](https://nodejs.org/) (versi√≥n 14 o superior)
- [npm](https://www.npmjs.com/) o [yarn](https://yarnpkg.com/)
- MongoDB (opcional, si usas la base de datos)

## ‚öôÔ∏è Instalaci√≥n

Clona el repositorio y entra en el directorio del proyecto:

```sh
git clone https://github.com/KelvinF87/serviairemote.git
cd serviairemote

Instala las dependencias necesarias:
npm install

üõ†Ô∏è Configuraci√≥n
Crea un archivo .env en la ra√≠z del proyecto con las siguientes variables:

PORT=3000
OPENROUTER_API_KEY=tu_clave_de_api
YOUR_SITE_URL=https://tu-sitio.com
YOUR_SITE_NAME=TuSitioAI
YOUR_MODEL_AI=nombre_del_modelo_ai
TOKEN_SECRET=tu_clave_secreta_jwt
MONGO_URI=mongodb+srv://usuario:contrase√±a@cluster.mongodb.net/database
CORS_ORIGIN=https://tu-sitio.com
BREVO_API_KEY=clave_api_brevo
EMAIL=tu_correo@example.com
NODE_ENV=development

Explicaci√≥n de las variables:

PORT: Puerto en el que se ejecutar√° el servidor Express.

OPENROUTER_API_KEY: Tu clave de API de OpenRouter.

YOUR_SITE_URL: La URL de tu sitio web.

YOUR_SITE_NAME: El nombre de tu sitio web.

YOUR_MODEL_AI: El nombre del modelo de IA que deseas utilizar en OpenRouter.

TOKEN_SECRET: Clave secreta para firmar los tokens JWT. ¬°IMPORTANTE! Debe ser una cadena aleatoria y segura.

MONGO_URI: URI de conexi√≥n a tu base de datos MongoDB.

CORS_ORIGIN: Origen permitido para las solicitudes CORS (normalmente la URL de tu frontend).

BREVO_API_KEY: Clave API para la integraci√≥n con Brevo (Sendinblue) para enviar emails.

EMAIL: La direcci√≥n de correo electr√≥nico que se utilizar√° para enviar emails.

NODE_ENV: Entorno de ejecuci√≥n (development o production).

Advertencia sobre la clave TOKEN_SECRET: La seguridad de tu aplicaci√≥n depende en gran medida de la confidencialidad de esta clave. NO LA INCLUYAS EN EL REPOSITORIO P√öBLICO NI LA COMPARTAS CON NADIE. Genera una clave aleatoria y segura utilizando herramientas como openssl rand -base64 32.

‚ñ∂Ô∏è Uso
Inicia el servidor con:

npm start

El servidor estar√° corriendo en http://localhost:3000 por defecto (a menos que especifiques otro puerto en el archivo .env).

üì° API
üîπ Endpoint: /chat
M√©todo: POST

Descripci√≥n: Permite enviar mensajes a OpenRouter AI y recibir respuestas generadas por la IA.

Cuerpo de la solicitud:

{
  "messages": [
    { "role": "user", "content": "Hola, ¬øc√≥mo est√°s?" }
  ]
}

Respuesta esperada:

{
  "choices": [
    {
      "message": { "role": "assistant", "content": "Hola, estoy aqu√≠ para ayudarte." }
    }
  ]
}

 Endpoints Adicionales (Ejemplo)
Dependiendo de la funcionalidad adicional que hayas implementado, podr√≠as tener endpoints como:

/register: Registrar un nuevo usuario.

/login: Autenticar un usuario y obtener un token JWT.

/protected: Un endpoint protegido que requiere un token JWT v√°lido.

/email: Enviar un email utilizando la integraci√≥n con Brevo.

(Recuerda documentar cualquier endpoint adicional que hayas implementado.)

üõ°Ô∏è Manejo de errores
Si falta alguna variable de entorno obligatoria, el servidor se detendr√°.

Si la API de OpenRouter falla, se devuelve un mensaje de error con detalles.

Validaci√≥n de errores de los datos de entrada usando express-validator.

Manejo de errores de autenticaci√≥n y autorizaci√≥n con JWT.

Manejo de errores de conexi√≥n a la base de datos MongoDB.

Centralizado el manejo de errores para una mejor gesti√≥n y reporting.

üìÑ Archivos Importantes
app.js: El archivo principal que inicia el servidor Express.

routes/: Directorio que contiene las definiciones de las rutas de la API.

controllers/: Directorio que contiene la l√≥gica de los controladores que manejan las peticiones a la API.

models/: Directorio que contiene las definiciones de los modelos de datos (Mongoose).

middleware/: Directorio que contiene middleware como la autenticaci√≥n JWT y CORS.

.env: Archivo de configuraci√≥n con las variables de entorno (¬°NO LO SUBAS AL REPOSITORIO!).

‚öôÔ∏è Desarrollo
Para reiniciar el servidor autom√°ticamente cada vez que cambies un archivo, usa:

npm run start

Esto ejecutar√° el script start definido en el package.json, que usa nodemon para vigilar los cambios.

üß™ Testing
Para realizar pruebas en tu API, considera usar herramientas como:

Postman: Para enviar peticiones HTTP manualmente y verificar las respuestas.

Jest/Mocha: Frameworks de testing para automatizar las pruebas unitarias y de integraci√≥n.

üìö Dependencias
Revisa el package.json para obtener una lista completa de las dependencias del proyecto y sus versiones.

ü§ù Contribuci√≥n
Las contribuciones son bienvenidas! Si encuentras un error o tienes una sugerencia, por favor crea un issue o env√≠a un pull request.

üìú Licencia
Este proyecto es de c√≥digo abierto y est√° disponible en GitHub.

üë®‚Äçüíª Autor: Kelvin Jose Familia Adames

üìß Contacto: docentekj@gmail.com

üîó Repositorio: GitHub - serviairemote

**Cambios y Adiciones:**

*   **Caracter√≠sticas Expandidas:**  Se han a√±adido detalles sobre las dependencias y su prop√≥sito (bcrypt, cookie-parser, express-rate-limit, express-validator, jsonwebtoken, mongoose, node-fetch, sib-api-v3-sdk).
*   **Explicaci√≥n Detallada del .env:**  Se proporciona una explicaci√≥n para cada variable en el archivo `.env`, incluyendo informaci√≥n sobre MongoDB y las claves API.
*   **Advertencia de Seguridad:** Se ha a√±adido una advertencia enf√°tica sobre la importancia de mantener la clave `TOKEN_SECRET` segura y no compartirla.
*   **Ejemplos de Endpoints Adicionales:** Se han a√±adido ejemplos de otros endpoints que podr√≠as tener (registro, login, endpoint protegido, env√≠o de email).  Se enfatiza la necesidad de documentar cualquier endpoint adicional.
*   **Estructura del Proyecto:** Se describe la estructura de directorios del proyecto, explicando el prop√≥sito de cada uno (routes, controllers, models, middleware).
*   **Desarrollo:** Se explica c√≥mo usar `nodemon` para el reinicio autom√°tico del servidor.
*   **Testing:** Se sugieren herramientas para realizar pruebas en la API.
*   **Dependencias:** Se recuerda revisar el `package.json` para la lista completa de dependencias.
*   **Contribuci√≥n:** Se anima a la gente a contribuir al proyecto.
*   **Formato:** Se mejor√≥ el formato general del README para una mejor legibilidad.

Este README actualizado proporciona mucha m√°s informaci√≥n y contexto para que otros puedan entender, configurar y usar tu proyecto ServIAIRemote.  Recuerda reemplazar los valores de ejemplo en el archivo `.env` con tus propias credenciales.